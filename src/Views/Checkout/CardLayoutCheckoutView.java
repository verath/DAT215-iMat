/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

/*
 * CardLayoutCheckoutView.java
 *
 * Created on Feb 27, 2013, 11:29:46 AM
 */
package Views.Checkout;

import Main.MainController;
import Main.NumberUtil;
import Main.ShoppingCartWrapper;
import java.awt.CardLayout;
import java.awt.Font;
import java.awt.Panel;
import javax.swing.JPanel;
import se.chalmers.ait.dat215.project.CreditCard;
import se.chalmers.ait.dat215.project.Customer;
import se.chalmers.ait.dat215.project.IMatDataHandler;

/**
 *
 * @author Philip
 */
public class CardLayoutCheckoutView extends javax.swing.JPanel {

    private int card = 1;

    /** Creates new form CardLayoutCheckoutView */
    public CardLayoutCheckoutView() {
        initComponents();
        cl = (CardLayout) (jPanel1.getLayout());
        imdh = IMatDataHandler.getInstance();
        customer = imdh.getCustomer();
        creditCard = imdh.getCreditCard();
        regularFont = new Font("Lucida Grande", Font.PLAIN, 13);
        highlightedFont = new Font("Lucida Grande", Font.BOLD, 13);
        shoppingCart.setFont(highlightedFont);
        payButton.setVisible(false);
        previousButton.setVisible(false);
        scw = ShoppingCartWrapper.INSTANCE;
    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel1 = new javax.swing.JPanel();
        firstCheckoutView1 = new Views.Checkout.FirstCheckoutView();
        secondCheckoutView1 = new Views.Checkout.SecondCheckoutView();
        thirdCheckoutView1 = new Views.Checkout.ThirdCheckoutView();
        fourthCheckoutView1 = new Views.Checkout.FourthCheckoutView();
        previousButton = new javax.swing.JButton();
        nextButton = new javax.swing.JButton();
        cancelButton = new javax.swing.JButton();
        payButton = new javax.swing.JButton();
        jPanel2 = new javax.swing.JPanel();
        confirmOrder = new javax.swing.JLabel();
        information = new javax.swing.JLabel();
        jLabel1 = new javax.swing.JLabel();
        shoppingCart = new javax.swing.JLabel();
        kvitt = new javax.swing.JLabel();

        org.jdesktop.application.ResourceMap resourceMap = org.jdesktop.application.Application.getInstance(Main.MainApp.class).getContext().getResourceMap(CardLayoutCheckoutView.class);
        setBackground(resourceMap.getColor("Form.background")); // NOI18N
        setName("Form"); // NOI18N

        jPanel1.setName("jPanel1"); // NOI18N
        jPanel1.setLayout(new java.awt.CardLayout());

        firstCheckoutView1.setBackground(resourceMap.getColor("firstCheckoutView1.background")); // NOI18N
        firstCheckoutView1.setName("firstCheckoutView1"); // NOI18N
        jPanel1.add(firstCheckoutView1, "firstCard");

        secondCheckoutView1.setBackground(resourceMap.getColor("secondCheckoutView1.background")); // NOI18N
        secondCheckoutView1.setName("secondCheckoutView1"); // NOI18N
        jPanel1.add(secondCheckoutView1, "card3");

        thirdCheckoutView1.setBackground(resourceMap.getColor("thirdCheckoutView1.background")); // NOI18N
        thirdCheckoutView1.setName("thirdCheckoutView1"); // NOI18N
        jPanel1.add(thirdCheckoutView1, "card4");

        fourthCheckoutView1.setBackground(resourceMap.getColor("fourthCheckoutView1.background")); // NOI18N
        fourthCheckoutView1.setName("fourthCheckoutView1"); // NOI18N
        jPanel1.add(fourthCheckoutView1, "card5");

        previousButton.setText(resourceMap.getString("previousButton.text")); // NOI18N
        previousButton.setName("previousButton"); // NOI18N
        previousButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                previousCard(evt);
            }
        });

        nextButton.setText(resourceMap.getString("nextButton.text")); // NOI18N
        nextButton.setName("nextButton"); // NOI18N
        nextButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                nextCard(evt);
            }
        });

        cancelButton.setText(resourceMap.getString("cancelButton.text")); // NOI18N
        cancelButton.setName("cancelButton"); // NOI18N
        cancelButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                cancelButtonpreviousCard(evt);
            }
        });

        payButton.setText(resourceMap.getString("payButton.text")); // NOI18N
        payButton.setName("payButton"); // NOI18N
        payButton.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                payButtonPressed(evt);
            }
        });

        jPanel2.setName("jPanel2"); // NOI18N
        jPanel2.setOpaque(false);

        confirmOrder.setFont(resourceMap.getFont("confirmOrder.font")); // NOI18N
        confirmOrder.setText(resourceMap.getString("confirmOrder.text")); // NOI18N
        confirmOrder.setName("confirmOrder"); // NOI18N

        information.setText(resourceMap.getString("information.text")); // NOI18N
        information.setName("information"); // NOI18N

        jLabel1.setFont(resourceMap.getFont("jLabel1.font")); // NOI18N
        jLabel1.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        jLabel1.setText(resourceMap.getString("jLabel1.text")); // NOI18N
        jLabel1.setName("jLabel1"); // NOI18N

        shoppingCart.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);
        shoppingCart.setText(resourceMap.getString("shoppingCart.text")); // NOI18N
        shoppingCart.setName("shoppingCart"); // NOI18N

        kvitt.setText(resourceMap.getString("kvitt.text")); // NOI18N
        kvitt.setName("kvitt"); // NOI18N

        org.jdesktop.layout.GroupLayout jPanel2Layout = new org.jdesktop.layout.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(jPanel2Layout.createSequentialGroup()
                .add(jLabel1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 162, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                .add(shoppingCart, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 108, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                .add(information, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 108, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                .add(confirmOrder, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 108, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                .add(kvitt, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 108, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(202, Short.MAX_VALUE))
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(jPanel2Layout.createSequentialGroup()
                .add(jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                    .add(jLabel1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 59, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                    .add(information, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 59, Short.MAX_VALUE)
                    .add(confirmOrder, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 59, Short.MAX_VALUE)
                    .add(kvitt, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 59, Short.MAX_VALUE)
                    .add(shoppingCart, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 59, Short.MAX_VALUE))
                .addContainerGap())
        );

        org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(layout.createSequentialGroup()
                .addContainerGap()
                .add(cancelButton)
                .add(134, 134, 134)
                .add(previousButton)
                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                .add(nextButton)
                .add(18, 18, 18)
                .add(payButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 229, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                .add(201, 201, 201))
            .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING)
                    .add(org.jdesktop.layout.GroupLayout.LEADING, jPanel1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 824, Short.MAX_VALUE)
                    .add(jPanel2, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
            .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
                .add(jPanel2, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(org.jdesktop.layout.LayoutStyle.UNRELATED)
                .add(jPanel1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 513, Short.MAX_VALUE)
                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
                    .add(nextButton)
                    .add(previousButton)
                    .add(cancelButton)
                    .add(payButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 61, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
                .add(115, 115, 115))
        );
    }// </editor-fold>//GEN-END:initComponents

    public void cardNumberUp() {
        if (card == 4) {
            card = 1;
        } else {
            card++;
        }
    }

    public void cardNumberDown() {
        if (card == 1) {
            card = 4;
        } else {
            card--;
        }
    }

    public void showFirstCard() {
        firstCheckoutView1.setItemsInCheckoutView(scw.getItems());

        card = 1;

        cl.show(jPanel1, "firstCard");
        updateNavigation();
    }

    public void updateNavigation() {
        if (card == 1) {
            shoppingCart.setFont(highlightedFont);
            information.setFont(regularFont);
            confirmOrder.setFont(regularFont);
            kvitt.setFont(regularFont);
            nextButton.setVisible(true);
            payButton.setVisible(false);
            previousButton.setVisible(false);
            cancelButton.setVisible(true);
        } else if (card == 2) {
            shoppingCart.setFont(regularFont);
            information.setFont(highlightedFont);
            confirmOrder.setFont(regularFont);
            kvitt.setFont(regularFont);
            nextButton.setVisible(true);
            payButton.setVisible(false);
            previousButton.setVisible(true);
            cancelButton.setVisible(true);
            secondCheckoutView1.updateCustomer();
        } else if (card == 3) {
            shoppingCart.setFont(regularFont);
            information.setFont(regularFont);
            confirmOrder.setFont(highlightedFont);
            kvitt.setFont(regularFont);
            nextButton.setVisible(false);
            payButton.setVisible(true);
            previousButton.setVisible(true);
            cancelButton.setVisible(true);
        } else if (card == 4) {
            shoppingCart.setFont(regularFont);
            information.setFont(regularFont);
            confirmOrder.setFont(regularFont);
            kvitt.setFont(highlightedFont);
            nextButton.setVisible(false);
            payButton.setVisible(false);
            previousButton.setVisible(false);
            cancelButton.setVisible(false);
        }
    }

    public void updateFirstCard() {
    }

    public void updateSecondCard() {
    }

    public void updateThirdCard() {
        thirdCheckoutView1.setAdress(customer.getAddress());
        thirdCheckoutView1.setPostalCode(customer.getPostCode());
        thirdCheckoutView1.setCity(customer.getPostAddress());
        thirdCheckoutView1.setPrice(NumberUtil.roundTwoDecimals(ShoppingCartWrapper.INSTANCE.getTotal()));
    }

private void nextCard(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_nextCard
    cardNumberUp();

    updateThirdCard();
    updateNavigation();
    if (card == 3) {
        secondCheckoutView1.saveSettings();
        fourthCheckoutView1.setThanksMessage();
    }

    cl.next(jPanel1);
}//GEN-LAST:event_nextCard

private void previousCard(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_previousCard
    cardNumberDown();
    updateNavigation();

    cl.previous(jPanel1);
}//GEN-LAST:event_previousCard

private void cancelButtonpreviousCard(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_cancelButtonpreviousCard
    MainController.INSTANCE.showMain();
}//GEN-LAST:event_cancelButtonpreviousCard

private void payButtonPressed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_payButtonPressed

    cardNumberUp();
    updateNavigation();
    cl.next(jPanel1);

    IMatDataHandler.getInstance().placeOrder(true);
    ShoppingCartWrapper.INSTANCE.fireShoppingCartChanged(null, true);
}//GEN-LAST:event_payButtonPressed
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton cancelButton;
    private javax.swing.JLabel confirmOrder;
    private Views.Checkout.FirstCheckoutView firstCheckoutView1;
    private Views.Checkout.FourthCheckoutView fourthCheckoutView1;
    private javax.swing.JLabel information;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JLabel kvitt;
    private javax.swing.JButton nextButton;
    private javax.swing.JButton payButton;
    private javax.swing.JButton previousButton;
    private Views.Checkout.SecondCheckoutView secondCheckoutView1;
    private javax.swing.JLabel shoppingCart;
    private Views.Checkout.ThirdCheckoutView thirdCheckoutView1;
    // End of variables declaration//GEN-END:variables
    CardLayout cl;
    IMatDataHandler imdh;
    Customer customer;
    CreditCard creditCard;
    Font regularFont;
    Font highlightedFont;
    ShoppingCartWrapper scw;
}
